% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_ch3_stats.R
\name{get_ch3_stats}
\alias{get_ch3_stats}
\title{Compute Statistics for a Ch3 File}
\usage{
get_ch3_stats(
  ch3_file,
  log_file = NULL,
  min_reads = c(1, 5, 10, 15),
  call_prob_threshold = 0.9,
  base_qual_threshold = 10,
  silently = FALSE
)
}
\arguments{
\item{ch3_file}{Character. Path to the Ch3 file in Parquet format.}

\item{log_file}{Character (optional). Path to a log file where the output 
will be written. If NULL, results are printed to the console.}

\item{min_reads}{Numeric vector. A set of thresholds for reporting CpG coverage 
at different minimum read counts. Default: \code{c(1, 5, 10, 15)}.}

\item{call_prob_threshold}{Numeric. The minimum modification probability 
to consider a high-confidence call. Default: \code{0.9}.}

\item{base_qual_threshold}{Numeric. The minimum base quality required 
to count as a high-quality call. Default: \code{10}.}

\item{silently}{Logical. If \code{TRUE}, suppresses console output. 
Default: \code{FALSE}.}
}
\value{
A list containing:
\describe{
  \item{\code{num_calls}}{Total number of modification calls in the file.}
  \item{\code{num_reads}}{Total number of unique reads in the file.}
  \item{\code{cpg_coverage}}{A matrix with CpG coverage counts at different 
  \code{min_reads} thresholds.}
  \item{\code{flag_counts}}{A data frame with the count and percentage of 
  calls per flag value.}
  \item{\code{high_conf_calls}}{A data frame with the count and percentage 
  of calls with modification probability above \code{call_prob_threshold}.}
  \item{\code{high_qual_calls}}{A data frame with the count and percentage 
  of calls with base quality above \code{base_qual_threshold}.}
  \item{\code{avg_read_length}}{The mean read length.}
}
}
\description{
This function computes various statistics for a given Ch3 file stored in 
Parquet format, including total calls, total reads, mean read length, 
CpG coverage at different read thresholds, flag distributions, and high-quality 
call counts based on probability and base quality thresholds.
}
\details{
The function reads the Ch3 file as a dataset and computes basic statistics 
about the calls and reads. It also evaluates CpG coverage based on different 
read count thresholds, distributions of flag values, and counts of high-quality 
calls based on user-defined probability and quality thresholds.

If a \code{log_file} is provided, the results are written to it. Otherwise, 
they are printed to the console unless \code{silently = TRUE}.
}
\examples{
\dontrun{
get_ch3_stats("example.ch3.parquet")
get_ch3_stats("example.ch3.parquet", log_file = "stats.log", silently = TRUE)
}

}
